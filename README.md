# Jenkins: Coverage / Complexity Scatter Plot with OpenClover and PMD

This guide will show you how to create a coverage/complexity scatter plot using Jenkins, OpenClover, and PMD.

## Prerequisites

- Jenkins installed and configured
- JDK 1.8 or more and Maven installed and configured in Jenkins
- Git plugin installed in Jenkins
- [OpenClover plugin](https://plugins.jenkins.io/clover/) installed in Jenkins
- [PMD plugin](https://plugins.jenkins.io/pmd/) installed in Jenkins
- [JaCoCo plugin](https://plugins.jenkins.io/jacoco/) installed in Jenkins

## Step 1: Configuring the build job

1. Go to the Jenkins dashboard and click on "New Item".
2. Choose a name for your job (e.g., "CoverageComplexityScatterPlot") and select "Maven project" as the job type.
3. Click "OK".

## Step 2: Configuring the source code and build steps

1. On the "Configure" page, under "Source Code Management", select "Git" and provide the URL of your GitHub repository containing the Maven project.

`https://github.com/manikcloud/Jenkins-cicd.git`

- **Branch Specifier:** `7.5complexity-scatter-plot`
2. Under "Build", click on "Add build step" and select "Invoke top-level Maven targets".
3. Select the Maven version you have configured in Jenkins.
4. Specify the goals as: `clean install jacoco:report pmd:pmd`

## Step 3: Configuring post-build actions for coverage and complexity data

1. Click on "Add post-build action" and select "Publish OpenClover coverage report".
- In "Path to Clover report XML", specify the path to the `clover.xml` file (e.g., `**/target/site/clover/clover.xml`).
2. Click on "Add post-build action" and select "Record JaCoCo coverage report".
- In "Path to exec files", specify the path to the `*.exec` files generated by JaCoCo (e.g., `**/target/jacoco.exec`).
- In "Path to source directories", specify the path to your project's source code (e.g., `**/src/main/java`).
- In "Path to class directories", specify the path to your project's compiled classes (e.g., `**/target/classes`).
3. Click on "Add post-build action" and select "Record compiler warnings and static analysis results".
- Click "Add Tool" and select "PMD".
- In "Pattern", specify the path to the PMD XML report file (e.g., `**/target/pmd.xml`).

## Step 4: Creating a custom scatter plot with Plot plugin

Please note that the Plot plugin is required to create a custom scatter plot. Follow the previous answer to install the Plot plugin and configure a custom scatter plot.


## Step 4: Creating a custom scatter plot with Plot plugin

1. Install the [Plot plugin](https://plugins.jenkins.io/plot/) if you haven't already.
2. In the job configuration page, click on "Add post-build action" and select "Plot build data".
3. Click "Add Plot".
4. Fill in the following details:
   - **Plot Title**: Coverage Complexity Scatter Plot
   - **Yaxis**: Complexity
   - **Yaxis Label**: Code Complexity
   - **Xaxis**: Coverage
   - **Xaxis Label**: Code Coverage
5. Click "Add Data Series".
6. Choose the data source for code complexity and code coverage. You may need to create custom scripts to extract this data from the OpenClover and PMD reports.
7. Click "Apply" and "Save".


## Step 5: Running the build and viewing the scatter plot

1. Click "Build Now" to run the build.
2. Once the build is complete, click on the build number in the "Build History".
3. In the left sidebar, click on "Coverage Complexity Scatter Plot" (or the custom scatter plot created using the Plot plugin) to view the scatter plot.

The scatter plot shows the relationship between code complexity (x-axis) and code coverage (y-axis). High-complexity and low-coverage code points will appear in the top-left quadrant of the plot, which are the parts of your code that may require refactoring or additional testing.
